<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>MSOE Teams Phone User Provisioning</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:Arial,sans-serif;background:#f5f5f5;padding:20px}
    .container{max-width:1600px;margin:0 auto}
    .main-layout{display:flex;gap:20px;flex-wrap:wrap}
    .left-panel{flex:2;min-width:800px}
    .right-panel{flex:1;min-width:400px}
    .columns{display:flex;gap:20px;flex-wrap:wrap}
    .column{flex:1;background:#e8e8e8;border:2px solid #999;border-radius:4px;
      padding:20px;display:flex;flex-direction:column;min-width:300px}
    .column-header{background:#d0d0d0;margin:-20px -20px 20px -20px;
      padding:10px 20px;font-weight:bold;border-bottom:1px solid #999}
    .form-group{margin-bottom:15px}
    .form-group label{display:block;margin-bottom:5px;font-weight:bold}
    .form-control{width:100%;padding:8px;border:1px solid #999;border-radius:4px}
    .radio-group{display:flex;gap:15px;margin-top:5px}
    .btn{padding:8px 15px;border:none;border-radius:4px;cursor:pointer;margin-top:auto}
    .btn-primary{background:#c41e3a;color:#fff}
    .btn-primary:disabled{background:#ccc;cursor:not-allowed}
    .btn-secondary{background:#0066cc;color:#fff}
    .btn-secondary:hover{background:#0052a3}
    .btn-danger{background:#dc3545;color:#fff}
    .btn-danger:hover{background:#c82333}
    .btn-success{background:#28a745;color:#fff}
    .btn-success:hover{background:#218838}
    .btn-small{padding:4px 8px;font-size:12px}
    .dynamic-section{border:1px solid #ccc;padding:10px;border-radius:4px;background:#f9f9f9;margin-bottom:10px}
    .dynamic-item{display:flex;justify-content:space-between;align-items:center;
      background:#fff;padding:5px;border-radius:3px;margin:5px 0}
    .user-info{background:#e3f2fd;border:1px solid #2196f3;padding:10px;border-radius:4px;margin-bottom:15px}
    .user-info h4{color:#1976d2;margin-bottom:10px}
    .current-setting{display:flex;justify-content:space-between;
      background:#fff;padding:5px;border-radius:3px;margin:3px 0}
    .success{background:#e6ffe6;color:#006600;padding:10px;border:1px solid #006600;border-radius:4px;margin-bottom:15px}
    .error{background:#ffe6e6;color:#cc0000;padding:10px;border:1px solid #cc0000;border-radius:4px;margin-bottom:15px}
    .warning{background:#fff3cd;color:#856404;padding:10px;border:1px solid #ffeaa7;border-radius:4px;margin-bottom:15px}
    .help-text{font-size:12px;color:#666;margin-top:3px;font-style:italic}
    
    /* Batch Operations Table Styles */
    .batch-panel{background:#f0f8ff;border:2px solid #4169e1;border-radius:4px;padding:20px}
    .batch-header{background:#4169e1;color:white;margin:-20px -20px 20px -20px;
      padding:10px 20px;font-weight:bold;border-bottom:1px solid #4169e1}
    .batch-table{width:100%;border-collapse:collapse;margin-bottom:20px}
    .batch-table th,.batch-table td{border:1px solid #ddd;padding:8px;text-align:left}
    .batch-table th{background:#e6f2ff;font-weight:bold}
    .batch-table .action-add{background:#e8f5e8}
    .batch-table .action-modify{background:#fff3cd}
    .batch-table .action-deprovision{background:#f8d7da}
    .batch-summary{background:#fff;border:1px solid #ddd;padding:10px;border-radius:4px;margin-bottom:15px}
    .remove-batch-item{background:#dc3545;color:white;border:none;padding:2px 6px;border-radius:3px;cursor:pointer;font-size:11px}
    .remove-batch-item:hover{background:#c82333}
    .batch-empty{text-align:center;color:#666;font-style:italic;padding:20px}
    
    /* Teams status indicator */
    .teams-status{background:#e3f2fd;border:1px solid #2196f3;padding:10px;border-radius:4px;margin-bottom:15px;text-align:center}
    .teams-status.authenticated{background:#e8f5e8;border-color:#4caf50;color:#2e7d32}
    .teams-status.error{background:#ffebee;border-color:#f44336;color:#c62828}
    
    @media(max-width:1200px){
      .main-layout{flex-direction:column}
      .left-panel,.right-panel{min-width:auto}
    }
    @media(max-width:800px){.columns{flex-direction:column}}
  </style>
</head>
<body>

  <div class="container">
    <!-- Teams Authentication Status -->
    <div id="teamsStatus" class="teams-status">
      🔄 Initializing Teams integration...
    </div>

    <div class="main-layout">
      
      <!-- LEFT PANEL - Forms -->
      <div class="left-panel">
        <div class="columns">

          <!-- ADD -->
          <div class="column">
            <div class="column-header">Add a Teams Phone User</div>
            <div id="addUserMessages"></div>

            <div class="form-group">
              <label for="addUsername">Select User:</label>
              <select id="addUsername" class="form-control">
                <option value="">Loading users…</option>
              </select>
              <div class="help-text">(A5 Faculty non-enterprise voice enabled)</div>
            </div>

            <div class="form-group">
              <label for="addPhoneNumber">Pick an available phone number:</label>
              <select id="addPhoneNumber" class="form-control">
                <option value="">Loading numbers…</option>
              </select>
            </div>

            <div class="form-group">
              <label>International Calling:</label>
              <div class="radio-group">
                <label><input type="radio" name="addIntlCalling" id="addIntlYes" value="yes"> Yes</label>
                <label><input type="radio" name="addIntlCalling" id="addIntlNo"  value="no" checked> No</label>
              </div>
            </div>

            <div class="form-group">
              <label>Teams Call Queue Group Membership(s):</label>
              <div id="addCallQueueGroups" class="dynamic-section">
                <div class="dynamic-item">
                  <select class="form-control cq-group-select">
                    <option value="">Loading Call Queue Groups…</option>
                  </select>
                  <button class="btn btn-danger btn-small" onclick="removeItem(this)">Remove</button>
                </div>
              </div>
              <button class="btn btn-secondary btn-small" onclick="addCallQueueGroup()">Add Another Group</button>
            </div>

            <div class="form-group">
              <label>Teams Auto Attendant Authorized User (Manager):</label>
              <div id="addAutoAttendants" class="dynamic-section">
                <div class="dynamic-item">
                  <select class="form-control aa-select">
                    <option value="">Loading Auto Attendants…</option>
                  </select>
                  <button class="btn btn-danger btn-small" onclick="removeItem(this)">Remove</button>
                </div>
              </div>
              <button class="btn btn-secondary btn-small" onclick="addAutoAttendant()">Add Another AA</button>
            </div>

            <div class="form-group">
              <label>Teams Call Queue Authorized User (Manager):</label>
              <div id="addCallQueueManagers" class="dynamic-section">
                <div class="dynamic-item">
                  <select class="form-control cq-select">
                    <option value="">Loading Call Queues…</option>
                  </select>
                  <button class="btn btn-danger btn-small" onclick="removeItem(this)">Remove</button>
                </div>
              </div>
              <button class="btn btn-secondary btn-small" onclick="addCallQueueManager()">Add Another CQ</button>
            </div>

            <div style="display:flex; gap:10px; margin-top:auto;">
              <button id="addUserSubmit" class="btn btn-primary submit-button" disabled style="flex:1;">
                Add to Batch Queue
              </button>
              <button id="clearAddForm" class="btn btn-secondary" style="flex:0 0 auto;">
                Clear Form
              </button>
            </div>
          </div>


          <!-- MODIFY -->
          <div class="column">
            <div class="column-header">Modify a Teams Phone User</div>
            <div id="modifyUserMessages"></div>

            <div class="form-group">
              <label for="modifyUsername">Username:</label>
              <input type="text" id="modifyUsername" class="form-control"
                     placeholder="Enter MSOE email to lookup user"/>
              <button id="modifyLookupBtn" class="btn btn-secondary"
                      style="margin-top:10px">Lookup User</button>
            </div>

            <div id="currentUserInfo" class="user-info" style="display:none">
              <h4>Current User Settings:</h4>
              <div id="currentSettings"></div>
            </div>

            <div id="modifyPhoneGroup" class="form-group" style="display:none">
              <label>Change Phone Number:</label>
              <select id="modifyPhoneNumber" class="form-control">
                <option value="">Select new phone number…</option>
              </select>
            </div>

            <div id="modifyIntlGroup" class="form-group" style="display:none">
              <label>International Calling:</label>
              <div class="radio-group">
                <label><input type="radio" id="modifyIntlYes" name="modifyIntlCalling" value="yes"> Yes</label>
                <label><input type="radio" id="modifyIntlNo"  name="modifyIntlCalling" value="no"> No</label>
              </div>
            </div>

            <div id="modifyCallQueueGroupsGroup" class="form-group" style="display:none">
              <label>Teams Call Queue Group Membership(s):</label>
              <div id="currentCallQueueGroups">
                <h5 style="color:#1976d2">Current Group Memberships:</h5>
                <div id="currentCallQueueGroupsList"></div>
              </div>
              <div class="dynamic-section">
                <div class="dynamic-item">
                  <select id="newCallQueueGroupSelect" class="form-control cq-group-select">
                    <option value="">Select to add…</option>
                  </select>
                  <button class="btn btn-secondary btn-small" onclick="addCallQueueGroupMembership()">Add</button>
                </div>
              </div>
            </div>

            <div id="modifyAutoAttendantsGroup" class="form-group" style="display:none">
              <label>Add Auto Attendant Manager:</label>
              <div id="currentAutoAttendants">
                <h5 style="color:#1976d2">Current Auto Attendants:</h5>
                <div id="currentAutoAttendantsList"></div>
              </div>
              <div class="dynamic-section">
                <div class="dynamic-item">
                  <select id="newAutoAttendantSelect" class="form-control aa-select">
                    <option value="">Select to add…</option>
                  </select>
                  <button class="btn btn-secondary btn-small" onclick="addAutoAttendantRole()">Add</button>
                </div>
              </div>
            </div>

            <div id="modifyCallQueueManagersGroup" class="form-group" style="display:none">
              <label>Add Call Queue Manager:</label>
              <div id="currentCallQueueManagers">
                <h5 style="color:#1976d2">Current CQ Managers:</h5>
                <div id="currentCallQueueManagersList"></div>
              </div>
              <div class="dynamic-section">
                <div class="dynamic-item">
                  <select id="newCallQueueSelect" class="form-control cq-select">
                    <option value="">Select to add…</option>
                  </select>
                  <button class="btn btn-secondary btn-small" onclick="addCallQueueRole()">Add</button>
                </div>
              </div>
            </div>

            <div id="modifyButtonGroup" style="display:flex; gap:10px; margin-top:auto;">
              <button id="modifyUserSubmit" class="btn btn-primary submit-button"
                      style="display:none; flex:1;">Add Modification to Batch</button>
              <button id="clearModifyForm" class="btn btn-secondary" style="flex:0 0 auto;">
                Clear Form
              </button>
            </div>
          </div>


          <!-- DEPROVISION -->
          <div class="column">
            <div class="column-header">Deprovision a Teams Phone User</div>
            <div id="deprovisionUserMessages"></div>

            <div class="form-group">
              <label for="deprovisionUsername">Username:</label>
              <input type="text" id="deprovisionUsername" class="form-control"
                     placeholder="Enter MSOE email"/>
              <button id="deprovLookupBtn" class="btn btn-secondary"
                      style="margin-top:10px">Lookup User</button>
            </div>

            <div id="deprovisionUserInfo" class="user-info" style="display:none">
              <h4>User to be Deprovisioned:</h4>
              <div id="deprovisionSettings"></div>
            </div>

            <div id="deprovisionButtonGroup" style="display:flex; gap:10px; margin-top:auto;">
              <button id="deprovisionUserSubmit" class="btn btn-danger submit-button"
                      style="display:none; flex:1;">Add Deprovision to Batch</button>
              <button id="clearDeprovisionForm" class="btn btn-secondary" style="flex:0 0 auto;">
                Clear Form
              </button>
            </div>
          </div>

        </div>
      </div>

      <!-- RIGHT PANEL - Batch Operations -->
      <div class="right-panel">
        <div class="batch-panel">
          <div class="batch-header">Batch Operations Queue</div>
          
          <div class="batch-summary">
            <strong>Summary:</strong>
            <div>Adds: <span id="batchAddCount">0</span></div>
            <div>Modifications: <span id="batchModifyCount">0</span></div>
            <div>Deprovisions: <span id="batchDeprovisionCount">0</span></div>
            <div><strong>Total: <span id="batchTotalCount">0</span></strong></div>
          </div>

          <div id="batchTableContainer">
            <div id="batchEmptyMessage" class="batch-empty">
              No operations queued. Use the forms on the left to add operations to the batch.
            </div>
            <table id="batchTable" class="batch-table" style="display:none">
              <thead>
                <tr>
                  <th>Action</th>
                  <th>Username</th>
                  <th>Details</th>
                  <th>Remove</th>
                </tr>
              </thead>
              <tbody id="batchTableBody">
              </tbody>
            </table>
          </div>

          <div style="margin-top:15px;">
            <button id="submitAllBatch" class="btn btn-success" style="width:100%; display:none">
              Submit All Operations
            </button>
            <button id="clearAllBatch" class="btn btn-secondary" style="width:100%; margin-top:10px; display:none">
              Clear All
            </button>
            <button id="resetPageBtn" class="btn btn-primary" style="width:100%; margin-top:10px; display:none">
              🔄 Reset Page
            </button>
          </div>

          <div id="batchResults" style="margin-top:15px;"></div>
        </div>
      </div>

    </div>
  </div>

  <!-- Teams SDK -->
  <script src="https://res.cdn.office.net/teams-js/2.0.0/js/MicrosoftTeams.min.js"></script>

  <script>
    // Configuration
    const API = {
      url: 'https://availablephonenumberapi.azurewebsites.net/api/GetAvailablePhoneNumbers',
      key: 'EsQlM7c0jssk1pzk83F5IYFV6SkZm6AXto3KSbXSA4JlAzFuN7cgbw=='
    };

    const AZURE_CONFIG = {
      functionAppClientId: 'f2068d39-85c7-4507-9fd3-0758b193b0a9',
      functionAppUrl: 'https://provisionteamsphonesystemusers-a5b3b9fjcxcva8g4.northcentralus-01.azurewebsites.net/api/TriggerRunbook'
    };

    // Global variables
    let phoneNumbers = [], dropdownData = null, currentUser = null;
    let batchOperations = [];
    let teamsContext = null;
    let isTeamsEnvironment = false;

    // Teams initialization
    async function initializeTeams() {
      try {
        await microsoftTeams.app.initialize();
        teamsContext = await microsoftTeams.app.getContext();
        isTeamsEnvironment = true;
        
        updateTeamsStatus('✅ Teams authenticated - SSO enabled', 'authenticated');
        console.log('Teams context:', teamsContext);
        
      } catch (error) {
        console.log('Not running in Teams environment:', error);
        isTeamsEnvironment = false;
        updateTeamsStatus('⚠️ Running outside Teams - using fallback authentication', 'warning');
      }
    }

    function updateTeamsStatus(message, type = '') {
      const statusEl = document.getElementById('teamsStatus');
      statusEl.textContent = message;
      statusEl.className = `teams-status ${type}`;
    }

    // Enhanced authentication for batch operations
    async function getAuthToken() {
      if (!isTeamsEnvironment) {
        // Fallback for non-Teams environment
        return null;
      }

      try {
        const token = await microsoftTeams.authentication.getAuthToken({
          resources: [`api://${AZURE_CONFIG.functionAppClientId}/.default`]
        });
        console.log('Successfully obtained auth token');
        return token;
      } catch (error) {
        console.error('Failed to get auth token:', error);
        throw new Error(`Authentication failed: ${error.message}`);
      }
    }

    // Enhanced submit function with SSO
    async function submitAllOperations() {
      if (batchOperations.length === 0) return;

      const submitBtn = document.getElementById('submitAllBatch');
      const originalText = submitBtn.textContent;
      submitBtn.disabled = true;

      try {
        if (isTeamsEnvironment) {
          // Teams SSO flow
          submitBtn.textContent = '🔐 Authenticating...';
          const token = await getAuthToken();
          
          submitBtn.textContent = '⚙️ Processing Operations...';
          
          const response = await fetch(AZURE_CONFIG.functionAppUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify({ operations: batchOperations })
          });

          await handleBatchResponse(response);
          
        } else {
          // Fallback to original API for non-Teams environment
          submitBtn.textContent = '⚙️ Processing Operations...';
          
          const results = [];
          let successCount = 0;
          let errorCount = 0;

          for (let operation of batchOperations) {
            try {
              const response = await fetch(`${API.url}?code=${API.key}`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(operation)
              });

              if (response.ok) {
                const result = await response.json();
                results.push({
                  operation: operation,
                  success: true,
                  message: result.message || `${operation.action} successful`
                });
                successCount++;
              } else {
                const error = await response.json();
                results.push({
                  operation: operation,
                  success: false,
                  message: error.error || 'Unknown error'
                });
                errorCount++;
              }
            } catch (error) {
              results.push({
                operation: operation,
                success: false,
                message: error.message || 'Network error'
              });
              errorCount++;
            }
          }

          displayBatchResults(results, successCount, errorCount);
          batchOperations = batchOperations.filter(op => 
            !results.find(r => r.operation.id === op.id && r.success)
          );
        }

      } catch (error) {
        console.error('Batch operation error:', error);
        displayBatchResults([{
          operation: { action: 'batch', username: 'system' },
          success: false,
          message: error.message || 'Operation failed'
        }], 0, 1);
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
        updateBatchTable();
        populatePhoneDropdowns();
      }
    }

    async function handleBatchResponse(response) {
      if (response.ok) {
        const result = await response.json();
        displayBatchResults([{
          operation: { action: 'batch', username: 'system' },
          success: true,
          message: result.message || 'All operations completed successfully'
        }], 1, 0);
        
        // Clear successful operations
        batchOperations = [];
        
      } else {
        const error = await response.json();
        displayBatchResults([{
          operation: { action: 'batch', username: 'system' },
          success: false,
          message: error.error || `HTTP ${response.status}: ${response.statusText}`
        }], 0, 1);
      }
    }

    // Initialize everything
    document.addEventListener('DOMContentLoaded', async () => {
      // Initialize Teams first
      await initializeTeams();
      
      // Load data
      loadPhoneNumbers();

      // ADD form events
      document.getElementById('addUsername').addEventListener('change', validateAddForm);
      document.getElementById('addPhoneNumber').addEventListener('change', validateAddForm);
      document.getElementById('addUserSubmit').onclick = addToBatch;
      document.getElementById('clearAddForm').onclick = clearAddFormOnly;
      
      // MODIFY form events
      document.getElementById('modifyLookupBtn').addEventListener('click', lookupUser);
      document.getElementById('modifyUserSubmit').onclick = addModifyToBatch;
      document.getElementById('clearModifyForm').onclick = clearModifyFormOnly;
      document.getElementById('modifyUsername').addEventListener('input', () => {
        const modifyField = document.getElementById('modifyUsername');
        const deprovisionField = document.getElementById('deprovisionUsername');
        validateUsername(modifyField, deprovisionField, 'modifyUserMessages', 'Deprovision');
      });

      // DEPROVISION form events
      document.getElementById('deprovLookupBtn').addEventListener('click', lookupDeprovisionUser);
      document.getElementById('deprovisionUserSubmit').onclick = addDeprovisionToBatch;
      document.getElementById('clearDeprovisionForm').onclick = clearDeprovisionFormOnly;
      document.getElementById('deprovisionUsername').addEventListener('input', () => {
        const deprovisionField = document.getElementById('deprovisionUsername');
        const modifyField = document.getElementById('modifyUsername');
        validateUsername(deprovisionField, modifyField, 'deprovisionUserMessages', 'Modify');
      });

      // BATCH operation events
      document.getElementById('submitAllBatch').onclick = submitAllOperations;
      document.getElementById('clearAllBatch').onclick = clearAllBatch;
      document.getElementById('resetPageBtn').onclick = resetPage;
    });

    // [Rest of the existing functions remain unchanged - keeping them exactly as they were]
    
    async function loadPhoneNumbers() {
      let r = await fetch(`${API.url}?code=${API.key}`);
      if (!r.ok) return console.error('Phone fetch failed');
      phoneNumbers = await r.json();
      populatePhoneDropdowns();

      r = await fetch(`${API.url}?code=${API.key}`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({action:'getdropdowndata'})
      });
      if (!r.ok) return console.error('Dropdown fetch failed');
      dropdownData = await r.json();
      populateDropdowns();
    }

    function populateDropdowns() {
      const uSel = document.getElementById('addUsername');
      uSel.innerHTML = '<option value="">Select a user…</option>';
      (dropdownData.a5Users||[]).forEach(u=>uSel.appendChild(new Option(u,u)));

      document.querySelectorAll('.cq-group-select').forEach(sel=>{
        sel.innerHTML = '<option value="">Select Call Queue Group…</option>';
        (dropdownData.callQueueGroups||[]).forEach(g=>sel.appendChild(new Option(g,g)));
      });

      document.querySelectorAll('.aa-select').forEach(sel=>{
        sel.innerHTML = '<option value="">Select Auto Attendant…</option>';
        (dropdownData.autoAttendants||[]).forEach(a=>sel.appendChild(new Option(a,a)));
      });

      document.querySelectorAll('.cq-select').forEach(sel=>{
        sel.innerHTML = '<option value="">Select Call Queue…</option>';
        (dropdownData.callQueues||[]).forEach(q=>sel.appendChild(new Option(q,q)));
      });
    }

    function populatePhoneDropdowns() {
      const p1 = document.getElementById('addPhoneNumber');
      p1.innerHTML = '<option value="">Select a phone number…</option>';
      phoneNumbers.filter(i=>i.AvailablePhoneNumber.startsWith('1414277'))
        .forEach(i=>p1.appendChild(new Option(i.AvailablePhoneNumber,i.AvailablePhoneNumber)));
      const p2 = document.getElementById('modifyPhoneNumber');
      if(p2){
        p2.innerHTML = '<option value="">Select a phone number…</option>';
        phoneNumbers.filter(i=>i.AvailablePhoneNumber.startsWith('1414277'))
          .forEach(i=>p2.appendChild(new Option(i.AvailablePhoneNumber,i.AvailablePhoneNumber)));
      }
    }

    function validateAddForm(){
      const u=!!document.getElementById('addUsername').value;
      const p=!!document.getElementById('addPhoneNumber').value;
      document.getElementById('addUserSubmit').disabled=!(u&&p);
    }

    function addToBatch(){
      const callQueueGroups = Array.from(document.querySelectorAll('#addCallQueueGroups .cq-group-select'))
                              .map(s=>s.value).filter(v=>v);
      
      const operation = {
        id: Date.now(),
        action: 'add',
        username: document.getElementById('addUsername').value,
        phoneNumber: document.getElementById('addPhoneNumber').value,
        a5Licensed: true,
        internationalCalling: document.getElementById('addIntlYes').checked,
        callQueueGroups: callQueueGroups,
        autoAttendants: Array.from(document.querySelectorAll('#addAutoAttendants .aa-select'))
                              .map(s=>s.value).filter(v=>v),
        callQueueManagers: Array.from(document.querySelectorAll('#addCallQueueManagers .cq-select'))
                              .map(s=>s.value).filter(v=>v)
      };

      batchOperations.push(operation);
      updateBatchTable();
      clearAddForm();
      showMessage('addUserMessages', 
        `<div class="success">User ${operation.username} added to batch queue</div>`);
    }

    function mapCallQueueGroupNames(userMembershipNames) {
      const nameMapping = {
        'Q_HelpdeskCQ1': 'Helpdesk CallQueue',
        'Q_PhoneDemoLab': 'PhoneDemoLab',
        'Q_Sysadmin_MFA_CQ': 'Sysadmin_MFA_CQ',
        'Q Admissions': 'Q G Admissions',
        'Q Athletics': 'Q G Athletics',
        'Q Benefits': 'Q G Benefits',
        'Q Career Connections': 'Q G Career Connections',
        'Q Counseling Services': 'Q G Counseling Services',
        'Q CPE': 'Q G CPE',
        'Q CREATE': 'Q G Create',
        'Q Custodial Hotline': 'Q G Custodial Hotline',
        'Q Dean of Students': 'Q G Dean of Students',
        'Q ECBE Department': 'Q G ECBE Department',
        'Q Financial Aid': 'Q G Financial Aid',
        'Q Grohmann Museum': 'Q G Grohmann Museum',
        'Q Housing': 'Q G Housing',
